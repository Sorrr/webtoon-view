window.rdg||(rdg={}),rdg.view=rdg.view||{},rdg.view.Scroller=function(){this.init.apply(this,arguments)},rdg.view.Scroller.prototype={init:function(a){this._elementId=a||"webtoon-view",this._pastY=0,this._oldY=0,this._events={scrollTop:[],scrollUp:[],scrollBottom:[],scrollDown:[]},this._buildIScroll(),this._bindEvents(),navigator.userAgent.match(/iPad;.*CPU.*OS 7_\d/i)&&(document.getElementsByTagName("html")[0].className="ipad ios7")},on:function(a,b){this._events[a].push(b)},off:function(a,b){var c,d;for(c=0,d=this._events[a].length;d>c;c++)this._events[a][c]===b&&this._events[a].splice(c,1)},refresh:function(){this._iscroll.refresh()},_buildIScroll:function(){var a={probeType:2,scrollbars:!0,useTransform:Modernizr.csstransforms,useTransition:Modernizr.csstransitions,fadeScrollbars:!1,shrinkScrollbars:!1};Modernizr.csstransforms3d&&(a.fadeScrollbars=!0),/iphone|ipad|ipod/i.test(navigator.userAgent)&&(a.shrinkScrollbars="scale"),this._iscroll=new IScroll("#"+this._elementId,a)},_bindEvents:function(){this._iscroll.on("scroll",this._onScrollFireEvent.bind(this)),this._iscroll.on("scrollEnd",this._onScrollEndFireEvent.bind(this)),document.addEventListener("resize",this._onResizeNativeScrollTop.bind(this)),document.addEventListener("touchmove",function(a){a.preventDefault()})},_onScrollFireEvent:function(){this._isTop()?this._fireEvent("scrollTop"):this._isScrollUp()&&this._isSufficient()?this._fireEvent("scrollUp"):this._isBottom()?this._fireEvent("scrollBottom"):this._isScrollDown()&&this._fireEvent("scrollDown"),this._pastY=this._iscroll.y},_onScrollEndFireEvent:function(){this._oldY=this._iscroll.y,this._isTop(this._oldY)?this._fireEvent("scrollTop"):this._isBottom(this._oldY)&&this._fireEvent("scrollBottom")},_onResizeNativeScrollTop:function(){window.scrollTo(0,0)},_isTop:function(a){return a=void 0===a?this._pastY:a,a>=0},_isBottom:function(a){return a=void 0===a?this._pastY:a,a<=this._iscroll.maxScrollY},_isScrollUp:function(){return this._iscroll.y>this._pastY&&this._iscroll.y>this._oldY},_isScrollDown:function(){return this._iscroll.y<this._pastY&&this._iscroll.y<this._oldY},_isSufficient:function(){return this._iscroll.y>this._oldY- -150},_fireEvent:function(a){var b,c,d=this._events[a];for(b=0,c=d.length;c>b;b++)d[b](this._iscroll)}},rdg.view.Sidebars=function(){this.init.apply(this,arguments)},rdg.view.Sidebars.STATUS={SHOW:0,HIDE:1},rdg.view.Sidebars.prototype={init:function(){this._welHeader=null,this._welFooter=null,this._hideTimer=0,this._showTimer=0,this._status=0,this._assignElements()},_assignElements:function(){this._elHeader=document.getElementsByTagName("header")[0],this._elFooter=document.getElementsByTagName("footer")[0]},hide:function(){if(this._status===rdg.view.Sidebars.STATUS.HIDE)return!1;var a=this;this._elHeader.className="hide",this._elFooter.className="hide",this._status=rdg.view.Sidebars.STATUS.HIDE,clearTimeout(this._showTimer),this._hideTimer=setTimeout(function(){a._elHeader.style.visibility="hidden",a._elFooter.style.visibility="hidden"},300)},show:function(){if(this._status===rdg.view.Sidebars.STATUS.SHOW)return!1;var a=this;this._elHeader.style.visibility="visible",this._elFooter.style.visibility="visible",this._status=rdg.view.Sidebars.STATUS.SHOW,clearTimeout(this._hideTimer),this._showTimer=setTimeout(function(){a._elHeader.className="",a._elFooter.className=""},100)},delayHide:function(a){var b=this;a=a||0,setTimeout(function(){b.hide()},a)},delayShow:function(a){var b=this;a=a||0,setTimeout(function(){b.show()},a)}};